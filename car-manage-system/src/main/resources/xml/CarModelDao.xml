<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.godric.cms.dao.CarModelDao">


  <select id="getCarModelList" resultType="com.godric.cms.common.dto.CarModelDTO">
    select
        m.`model_name`,
        m.`stock`,
        i.`image_url` as mainImageUrl
    from `car_model` m
    left join `car_image` i on m.`id` = i.`model_id` and i.`sort` = 1
    <include refid="queryCondition" />
    <if test="startNum != null and startNum >= 0 and pageSize != null and pageSize > 0">
      limit #{startNum}, #{pageSize}
    </if>
  </select>
  <select id="countCarModelList" resultType="java.lang.Integer">
    select
        count(1)
    from `car_model` m
    left join `car_image` i on m.`id` = i.`model_id` and i.`sort` = 1
    <include refid="queryCondition" />
  </select>

  <sql id="queryCondition">
    <if test="modelName != null and modelName neq ''">
      where m.`model_name` like concat('%', #{modelName}, '%')
    </if>
  </sql>
</mapper>